<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:p="http://primefaces.org/ui"
     xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:pe="http://primefaces.org/ui/extensions">
    <p:tab title="Edycja danych podatnika">
        <h:form id="form">
            <p:outputPanel id="wrapper" rendered="#{podatnikView.selected.firmafk ne 1}">
                <p:growl life="3600"  id="msg" ><p:autoUpdate/></p:growl>
                
                <p:focus for="wprowadzaniepodatnika"/>
                <p:panelGrid id="wprowadzaniepodatnika" columns="4">
                    <h:outputLabel value="nip"/>
                    <p:inputText id="polenip" value="#{podatnikView.selected.nip}" maxlength="10" required="true" requiredMessage="NIP - jest wymagany, uzupełnij!" readonly="true">
                        <f:validateLength minimum="10"/>
                    </p:inputText>
                     <h:outputLabel value="nazwa pełna"/>
                     <p:inputText id="nazwapelna" value="#{podatnikView.selected.printnazwa}" required="true" requiredMessage="Nazwa pełna jest wymagana, uzupełnij!" style="width: 300px;">
                        <p:ajax event="blur" global="false" partialSubmit="true" />
                    </p:inputText>
                    <h:outputLabel value="nazwisko"/>
                    <p:inputText id="nazwisko" value="#{podatnikView.selected.nazwisko}" required="true" requiredMessage="Nazwisko - jest wymagane, uzupełnij!"/>
                    <h:outputLabel value="imię"/>
                    <p:inputText id="imie" value="#{podatnikView.selected.imie}" required="true" requiredMessage="Imię - jest wymagane, uzupełnij!"/>
                    <h:outputLabel value="pesel"/>
                    <p:inputText id="pesel" value="#{podatnikView.selected.pesel}" maxlength="11" required="true" requiredMessage="Pesel - jest wymagany, uzupełnij!">
                        <f:validateLength minimum="11"/>
                    </p:inputText>
                    <h:outputLabel value="regon"/>
                    <p:inputText id="regon" value="#{podatnikView.selected.regon}" maxlength="9" required="true" requiredMessage="Regon - jest wymagany, uzupełnij!">
                        <f:validateLength minimum="9"/>
                    </p:inputText>
                    <h:outputLabel value="telefon w formacie (+48...)"/>
                    <p:inputText id="telefon" value="#{podatnikView.selected.telefonkontaktowy}"  required="true" requiredMessage="Telefon - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="fax"/>
                    <p:inputMask id="fax" value="#{podatnikView.selected.fax}" mask="99-999-99-99">
                    </p:inputMask>
                    <h:outputLabel value="email"/>
                    <p:inputText id="email" value="#{podatnikView.selected.email}" required="true" requiredMessage="Email - jest wymagany, uzupełnij!">
                                  <f:validateRegex pattern="[\w\.-]*[a-zA-Z0-9_]@[\w\.-]*[a-zA-Z0-9]\.[a-zA-Z][a-zA-Z\.]*[a-zA-Z]" />
                    </p:inputText>
                    <h:outputLabel value="data urodzenia"/>
                    <p:inputMask id="dataurodzenia" value="#{podatnikView.selected.dataurodzenia}" mask="9999-99-99" required="true" requiredMessage="Data urodzenia - jest wymagana, uzupełnij!"
                                 onblur="weryfikujsporzadzfakture(this);"/>
                    <h:outputLabel value="data rozpoczęcia działalności"/>
                    <p:inputMask id="datarozpoczecia" value="#{podatnikView.selected.datarozpoczecia}" mask="9999-99-99" required="true" requiredMessage="Data rozpoczęcia - jest wymagana, uzupełnij!"
                                 onblur="weryfikujsporzadzfakture(this);"/>
                    <h:outputLabel value="województwo"/>
                    <h:selectOneMenu value="#{podatnikView.selected.wojewodztwo}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                        <f:selectItem itemLabel="wybierz" itemValue="wybierz" noSelectionOption="true"/>
                        <f:selectItem itemLabel="Zagranica" itemValue="Zagranica"/>
                        <f:selectItems value="#{wojewodztwa.wykazS}" />
                    </h:selectOneMenu>
                    <h:outputLabel value="powiat"/>
                    <p:inputText id="powiat" value="#{podatnikView.selected.powiat}" required="true" requiredMessage="Powiat - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="gmina"/>
                    <p:inputText id="gmina" value="#{podatnikView.selected.gmina}" required="true" requiredMessage="Gmina - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="miejscowość"/>
                    <p:inputText id="miejscowosc" value="#{podatnikView.selected.miejscowosc}" required="true" requiredMessage="Miejscowość - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="kod pocztowy"/>
                    <p:inputText id="kod" value="#{podatnikView.selected.kodpocztowy}" required="true" requiredMessage="Kod pocztowy - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="poczta"/>
                    <p:inputText id="poczta" value="#{podatnikView.selected.poczta}" required="true" requiredMessage="Poczta - jest wymagana, uzupełnij!"/>
                    <h:outputLabel value="ulica"/>
                    <p:inputText id="ulica" value="#{podatnikView.selected.ulica}"/>
                    <h:outputLabel value="nr domu"/>
                    <p:inputText id="nrdomu" value="#{podatnikView.selected.nrdomu}" required="true" requiredMessage="Nr domu - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="nr lokalu"/>
                    <p:inputText id="nrlokalu" value="#{podatnikView.selected.nrlokalu}"/>
                    <h:outputLabel value="vat metoda kasowa"/>
                    <h:selectOneMenu value="#{podatnikView.selected.metodakasowa}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                        <f:selectItem itemValue="wybierz" noSelectionOption="true"/>
                        <f:selectItem itemValue="nie"/>
                        <f:selectItem itemValue="tak"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="podatek dochodowy metoda kasowa"/>
                    <h:selectOneMenu value="#{podatnikView.selected.metodakasowapit}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                        <f:selectItem itemValue="wybierz" noSelectionOption="true"/>
                        <f:selectItem itemLabel="nie" itemValue="false"/>
                        <f:selectItem itemLabel="tak" itemValue="true"/>
                    </h:selectOneMenu>
                     <h:outputLabel value="forma prawna"/>
                    <h:selectOneMenu value="#{podatnikView.selected.formaPrawna}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');"  required="true" requiredMessage="Wybierz formę prawną">
                        <f:selectItem itemLabel="wybierz forme prawna" itemValue="" noSelectionOption="true"/>
                        <f:selectItems value="#{podatnikView.formyprawne}"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="urząd skarbowy"/>
                    <p:autoComplete completeMethod="#{tKodUS.complete}" value="#{podatnikView.selected.urzadskarbowy}"
                                    forceSelection="true" maxResults="15" size="50" minQueryLength="3" effect="clip" var="p"
                                    itemLabel="#{p}" itemValue="#{p}">
                        <f:facet name="itemtip">  
                            <h:panelGrid  columns="2" cellpadding="5" width="400">  
                                <f:facet name="header">  
                                    <h:outputText value="Dane wybranego urzędu"/>
                                </f:facet>  
                                <h:outputText value="Nazwa: " />  
                                <h:outputText id="npelna" value="#{p}" />  
                            </h:panelGrid>
                        </f:facet>
                    </p:autoComplete>
                    <h:outputLabel value="rodzaj ewidencji"/>
                     <h:selectOneMenu value="#{podatnikView.selected.firmafk}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                     <f:selectItem itemLabel="wybierz" itemValue="-1" noSelectionOption="true"/>
                     <f:selectItem itemLabel="firma fk" itemValue="1"/>
                     <f:selectItem itemLabel="firma pkpir" itemValue="0"/>
                     <f:selectItem itemLabel="firma fk/pkpir" itemValue="3"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="firma w likwidacji"/>
                 <p:selectBooleanCheckbox value="#{podatnikView.selected.jestwlikiwdacji}"/>
                 <h:outputLabel value="wysyłanie deklaracji tylko z podpisem kwalifikowanym"/>
                 <p:selectBooleanCheckbox value="#{podatnikView.selected.podpiscertyfikowany}" />
                 <h:outputLabel value="kod ubezpieczenia ZUS"/>
            <p:selectOneMenu value="#{podatnikView.selected.kodubezpieczeniaZUS}">
                <f:selectItem itemLabel="wybierz" noSelectionOption="true"/>
                <f:selectItem itemLabel="05 10" itemValue="051000"/>
                <f:selectItem itemLabel="05 11" itemValue="051100"/>
                <f:selectItem itemLabel="05 12" itemValue="051200"/>
                <f:selectItem itemLabel="05 13" itemValue="051300"/>
                <f:selectItem itemLabel="05 40" itemValue="054000"/>
                <f:selectItem itemLabel="05 43" itemValue="054300"/>
                <f:selectItem itemLabel="05 70" itemValue="057000"/>
                <f:selectItem itemLabel="05 72" itemValue="057200"/>
            </p:selectOneMenu>
            <h:outputLabel value="podatnik tylko dla ZUS"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.tylkodlaZUS}"/>
            <h:outputLabel value="zatrudnia pracowikow"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.zatrudniapracownikow}"/>
            <h:outputLabel value="ma kasę fiskalną"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.kasafiskalna}"/>
                </p:panelGrid>
                <p:panelGrid columns="1">
                    <p:commandButton action="#{podatnikView.edytuj()}" value="edytuj podatnika" update="@form" type="submit"/>
                </p:panelGrid>
            </p:outputPanel>
        </h:form>
        <h:form id="formwprowadzaniefirmy">
            <p:outputPanel id="wrapper" rendered="#{podatnikView.selected.firmafk eq 1}" style="height: 600px;">
                <p:growl life="3600"  id="msg" ><p:autoUpdate/></p:growl>
            <!--        wpisywanie firmy-->
                
                <p:panel id="panelwpisywanianowejfirmy" header="Edycja danych firmy w programie" style="width: 1150px;">
                <p:focus for="wprowadzaniepodatnika"/>
                <p:panelGrid id="wprowadzaniepodatnika" columns="4" >

                    <h:outputLabel value="nip firmy"/>
                    <p:inputMask id="polenip" value="#{podatnikView.selected.nip}" maxlength="10" required="true" requiredMessage="NIP - jest wymagany, uzupełnij!" readonly="true"
                             mask="9999999999" validatorMessage="Nip powinien składać się z 10 cyfr">
                    <f:validateLength minimum="10" />
                    </p:inputMask>
                    <h:outputLabel value="nazwa pełna"/>
                    <p:inputText id="nazwapelna" value="#{podatnikView.selected.printnazwa}"  required="true" requiredMessage="Nazwa pełna jest wymagana, uzupełnij!" style="width: 300px;"/>
                    <h:outputLabel value="nazwa skrócona"/>
                    <p:inputText id="nazwisko" value="#{podatnikView.selected.nazwisko}" required="true" requiredMessage="Nazwa skrócona jest wymagana, uzupełnij!"/>
                    <h:outputLabel value="nr KRS"/>
                    <p:inputText id="imie" value="#{podatnikView.selected.imie}" required="true" requiredMessage="Numer KRS jest wymagany, uzupełnij!"/>

                    <h:outputLabel value="regon"/>
                    <p:inputText id="regon" value="#{podatnikView.selected.regon}" maxlength="9" required="true" requiredMessage="Regon jest wymagany, uzupełnij!">
                        <f:validateLength minimum="9"/>
                    </p:inputText>
                    <h:outputLabel value="data rozpoczęcia działalności"/>
                    <p:inputMask id="datarozpoczecia" value="#{podatnikView.selected.datarozpoczecia}" mask="9999-99-99" required="true" requiredMessage="Data rozpoczęcia - jest wymagana, uzupełnij!"
                                 onblur="weryfikujsporzadzfakture(this);"/>
                    <h:outputLabel value="telefon"/>
                    <p:inputText id="telefon" value="#{podatnikView.selected.telefonkontaktowy}" required="true" requiredMessage="Telefon - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="fax"/>
                    <p:inputMask id="fax" value="#{podatnikView.selected.fax}" mask="99-999-99-99">
                    </p:inputMask>
                    <h:outputLabel value="email"/>
                    <p:inputText id="email" value="#{podatnikView.selected.email}" required="true" requiredMessage="Email - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="data rozpoczęcia dział."/>
                    <p:inputMask id="dataurodzenia" value="#{podatnikView.selected.dataurodzenia}" mask="9999-99-99" required="true" requiredMessage="Data urodzenia - jest wymagana, uzupełnij!"
                                 onblur="weryfikujsporzadzfakture(this);"/>
                    <h:outputLabel value="województwo"/>
                    <h:selectOneMenu value="#{podatnikView.selected.wojewodztwo}" styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                     onfocus="$(this).addClass('ui-state-focus');" 
                                     onblur="$(this).removeClass('ui-state-focus');">
                        <f:selectItems value="#{wojewodztwa.wykazS}" />
                        <p:ajax event="change" partialSubmit="true" global="false"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="powiat"/>
                    <p:inputText id="powiat" value="#{podatnikView.selected.powiat}" required="true" requiredMessage="Powiat - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="gmina"/>
                    <p:inputText id="gmina" value="#{podatnikView.selected.gmina}" required="true" requiredMessage="Gmina - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="miejscowość"/>
                    <p:inputText id="miejscowosc" value="#{podatnikView.selected.miejscowosc}" required="true" requiredMessage="Miejscowość - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="kod pocztowy"/>
                    <p:inputMask id="kod" value="#{podatnikView.selected.kodpocztowy}" mask="99-999" required="true" requiredMessage="Kod pocztowy - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="poczta"/>
                    <p:inputText id="poczta" value="#{podatnikView.selected.poczta}" required="true" requiredMessage="Poczta - jest wymagana, uzupełnij!"/>
                    <h:outputLabel value="ulica"/>
                    <p:inputText id="ulica" value="#{podatnikView.selected.ulica}"/>
                    <h:outputLabel value="nr domu"/>
                    <p:inputText id="nrdomu" value="#{podatnikView.selected.nrdomu}" required="true" requiredMessage="Nr domu - jest wymagany, uzupełnij!"/>
                    <h:outputLabel value="nr lokalu"/>
                    <p:inputText id="nrlokalu" value="#{podatnikView.selected.nrlokalu}"/>
                    <h:outputLabel value="VAT metoda kasowa"/>
                    <h:selectOneMenu value="#{podatnikView.selected.metodakasowa}" styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                     onfocus="$(this).addClass('ui-state-focus');" 
                                     onblur="$(this).removeClass('ui-state-focus');">
                        <f:selectItem itemValue="wybierz" noSelectionOption="true"/>
                        <f:selectItem itemValue="nie"/>
                        <f:selectItem itemValue="tak"/>
                    </h:selectOneMenu>
                     <h:outputLabel value="podatek dochodowy metoda kasowa"/>
                    <h:selectOneMenu value="#{podatnikView.selected.metodakasowapit}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                        <f:selectItem itemValue="wybierz" noSelectionOption="true"/>
                       <f:selectItem itemLabel="nie" itemValue="false"/>
                        <f:selectItem itemLabel="tak" itemValue="true"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="forma prawna"/>
                    <h:selectOneMenu value="#{podatnikView.selected.formaPrawna}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                        <f:selectItem itemLabel="wybierz forme prawna" itemValue="" noSelectionOption="true"/>
                        <f:selectItems value="#{podatnikView.formyprawne}"/>
                    </h:selectOneMenu>
                    <h:outputLabel value="urząd skarbowy VAT"/>
                    <p:autoComplete completeMethod="#{tKodUS.complete}" value="#{podatnikView.selected.urzadskarbowy}"
                                    forceSelection="true" maxResults="15" size="50" minQueryLength="3" effect="clip" var="p"
                                    itemLabel="#{p}" itemValue="#{p}">
                        <f:facet name="itemtip">  
                            <h:panelGrid  columns="2" cellpadding="5" width="400">  
                                <f:facet name="header">  
                                    <h:outputText value="Dane wybranego urzędu"/>
                                </f:facet>  
                                <h:outputText value="Nazwa: " />  
                                <h:outputText id="npelna" value="#{p}" />  
                            </h:panelGrid>
                        </f:facet>
                    </p:autoComplete>
                 <h:outputLabel value="rodzaj ewidencji"/>
                 <h:selectOneMenu value="#{podatnikView.selected.firmafk}"
                                     styleClass="ui-selectonemenu-label ui-inputfield ui-corner-all"
                                 onfocus="$(this).addClass('ui-state-focus');" 
                                 onblur="$(this).removeClass('ui-state-focus');" >
                     <f:selectItem itemLabel="wybierz" itemValue="-1" noSelectionOption="true"/>
                     <f:selectItem itemLabel="firma fk" itemValue="1"/>
                     <f:selectItem itemLabel="firma pkpir" itemValue="0"/>
                     <f:selectItem itemLabel="firma fk/pkpir" itemValue="3"/>
                    </h:selectOneMenu>
                 <h:outputLabel value="firma w likwidacji"/>
                 <p:selectBooleanCheckbox value="#{podatnikView.selected.jestwlikiwdacji}"/>
                 <h:outputLabel value="data otwarcia likwidacji"/>
                 <p:inputMask value="#{podatnikView.selected.dataotwarcialikwidacji}" mask="9999-99-99" 
                    onblur="weryfikujsporzadzfakture(this);"/>
                 <h:outputLabel value="wysyłanie deklaracji tylko z podpisem kwalifikowanym"/>
                 <p:selectBooleanCheckbox value="#{podatnikView.selected.podpiscertyfikowany}" disabled="#{facesContext.externalContext.remoteUser ne '4'}"/>
                 
                 <h:outputLabel value="podatnik tylko dla ZUS"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.tylkodlaZUS}"/>
            <h:outputLabel value="zatrudnia pracowikow"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.zatrudniapracownikow}"/>
            <h:outputLabel value="ma kasę fiskalną"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.kasafiskalna}"/>
            <h:outputText value="wysyłać dane o składkach ZUS i PIT4 na mail: #{podatnikView.selected.email ne null ? podatnikView.selected.email : 'brak mail'}"/>
            <p:selectBooleanCheckbox value="#{podatnikView.selected.wysylkazusmail}" label="wysyłać dane o wysokości ZUS i PIT-4"  valueChangeListener="#{podatnikView.zmianaWysylkaZus}">
            </p:selectBooleanCheckbox>
                    <h:outputLabel value="id firmy"/>
                 <h:outputText value="#{podatnikView.selected.nazwapelna}"/>
                </p:panelGrid>
                <p:panelGrid columns="1">
                    <p:commandButton action="#{podatnikView.edytujfk()}" value="edytuj podatnika" update="@form" type="submit" style="margin-top: 10px;"/>
                </p:panelGrid>
                </p:panel>
             </p:outputPanel>
        </h:form>
    </p:tab>
</ui:composition> 
